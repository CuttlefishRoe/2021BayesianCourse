第19章
# 参数非线性模型
---------------
第四部分中的提出的线性回归方法建议以表单的形式展示统计模型，使用一组响应变量的可能分布，一组促进这些分布使用的转换和以线性预测形式包涵信息的能力。在广义线性模型中，y的期望值是线性预测器的非线性函数：$E(y|X,\beta)=g^{-1}(X\beta)$。鲁棒性（第17章）和混合模型（第22章）通过为每个数据点添加一个潜在的（未观察到的）混合参数来推广这些参数。

广义线性建模是灵活和强大的，系数$\beta$相对容易解释，特别是当相互比较时（因为它们都作用于同一个线性预测器上）。然而，并不是所有的现象都是线性的，即使是在变换下。本章考虑了参数和预测器不是线性组合的更一般的情况。简单的例子包括$E(y)=\frac{a_{1}+b_{1}x_{1}}{a_{2}+b_{2}x_{2}}$，或者两个非线性函数求和，例如$E(y)=A_{1}e^{-a_{1}x}+A_{2}e^{-a_{2}x}$；见练习19.3。

推理和计算的一般原理可以直接应用于非线性模型。我们简要地考虑了贝叶斯数据分析的三个步骤：模型构建、模型计算和模型检查。最灵活的非线性建模方法通常涉及预测器和结果之间的复杂关系，但通常不需要不常用的概率分布。模型计算可能会带来挑战，因为我们不能简单地采用线性回归进行计算，比如在第16章中对广义线性模型所做的那样。模型检查有时可以使用残差图，卡方检验和其他现有的汇总，但有时需要在特定模型中创建一些新的图表。

此外，在解释不能简单地用线性预测器来理解的参数方面也出现了新的困难。任何非线性模型推理的关键步骤是以图形方式来显示拟合的非线性关系。因为非线性模型有很多种形式，所以没有系统的选项菜单来呈现。通常，每个新的建模问题都必须重新解决。我们提出了两个来自我们自己的应用研究的例子，以给出一些可能性。

## 19.1 示例：连续稀释实验

估计生物样品中化合物浓度的一种常见设计是连续稀释试验，在该试验中，在样品的几种不同稀释度下进行测量。每个样品的连续稀释的原因是试验中的浓度通过颜色变化的自动光学读数来量化，并且颜色变化体现的浓度范围的信息有限：在低值时，颜色变化难以察觉；在高值时，颜色饱和。因此，几种稀释剂提供了几种精确测量的机会。

更准确地说，稀释度给出了几种不同精度的测量值，而似然或贝叶斯方法应该允许我们适当地结合这些测量中的信息。一个试验是在一个有许多孔的板上，每个孔包含一个样品或一个样品的特定稀释。这里有两种样品：未知样品，是要测量的样品及其稀释度；标准样品，是已知稀释度的化合物，用于校准测量度。图19.1展示了一个有96孔的典型板；前两列包含标准样品及其稀释度，后10列是未知样品的稀释度数值。未知样品的稀释度比标准样品的间隔更宽，以便用给定数量的测定方法覆盖更广的浓度范围。


图19.1 典型的96孔平板设置，用于连续稀释试验。前两列是已知浓度的“标准”稀释剂，其他列是十种不同的未知样品。检测的目的是用标准作为校准，估计未知物质的浓度。

图19.2 数据来自单一板的连续稀释试验。大图显示标准数据，十个小图显示未知化合物的数据。分析的目标是找出如何缩放未知数的x轴，使它们与从标准估计的曲线一致。（这些图中显示的曲线是根据第19.1节中描述的模型估计的。）

### 实验数据

图19.2显示了哮喘患者家中蟑螂过敏原研究的单一平板的数据。每个图显示了单个化合物的光学测量y与稀释度以及描述二者关系的估计曲线。下面描述与测量值有关的稀释曲线的估计。



图19.3用稀释试验的标准软件分析的来自一个板的光学测量y的示例。标准数据被用来估计校准曲线，然后用来估计未知的浓度。用星号表示的浓度标为“低于检测下限。”然而，在这些低浓度的观察中，信息是存在的，这可以通过观察每个样本中稀释1到1/3到1/9的测量值递减模式来知道。

图19.3说明了目前估计未知浓度的标准方法的困难。图的左边显示了标准数据（对应于图19.2中的第一个图）：两个初始样品已知浓度为0.64，每个样品都经过几次稀释以及一次零测量。对于浓度为0.64的样品，光学颜色测量y开始于100 以上，并且对于零浓度（所有惰性化合物）样品，测量y下降到14左右。图19.3的右侧显示了对于平板上10个未知样品中的2个样品中的颜色测量值y和基于标准方法测得的相应浓度估计值。



